# LA提升_node_strong_override

目标：在固定数据口径下，比较多种方案对 Final（以及 LA/TA/Explainability/Efficiency）的影响。

## 试验设置
- metadata: `../metadata_phase1.csv`
- ground truth: `../AIOpsChallengeJudge/ground_truth_phase1.jsonl`
- telemetry root: `../data`
- dates（按天全量）: 2025-06-07, 2025-06-08
- suite slug: `la_boost_v5_node_strong_override`（对应 outputs/experiments/la_boost_v5_node_strong_override/）

## 候选方案
- 方案A：对照（strong override 关闭）（key=base_safe）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_USE_LEGACY_MEMORY": "0", "RCA_STRIP_REPLICA_SUFFIX": "1", "RCA_DISABLE_LLM": "1", "RCA_ENABLE_NODE_STRONG_OVERRIDE": "0"}`
- 方案B：开启 strong node override（score>=6 优先 node）（key=node_strong_on）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_USE_LEGACY_MEMORY": "0", "RCA_STRIP_REPLICA_SUFFIX": "1", "RCA_DISABLE_LLM": "1", "RCA_ENABLE_NODE_STRONG_OVERRIDE": "1", "RCA_NODE_STRONG_SCORE": "6.0", "RCA_NODE_STRONG_MARGIN": "0.08"}`
- 方案C：strong override + 保留 replica 后缀（key=node_strong_on_keep_replica）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_USE_LEGACY_MEMORY": "0", "RCA_STRIP_REPLICA_SUFFIX": "0", "RCA_DISABLE_LLM": "1", "RCA_ENABLE_NODE_STRONG_OVERRIDE": "1", "RCA_NODE_STRONG_SCORE": "6.0", "RCA_NODE_STRONG_MARGIN": "0.08"}`

## 结果汇总（按日期评测；并给出跨日期平均）

| 方案 | 平均LA | 平均TA | 平均Explain | 平均Eff | 平均Final |
|---|---:|---:|---:|---:|---:|
| 方案A：对照（strong override 关闭） | 14.58% | 52.08% | 11.31% | 81.87% | 35.99 |
| 方案B：开启 strong node override（score>=6 优先 node） | 10.42% | 50.00% | 6.20% | 81.87% | 32.97 |
| 方案C：strong override + 保留 replica 后缀 | 10.42% | 43.75% | 4.35% | 81.87% | 30.29 |

## 分日期明细

| date | N | 方案key | LA | TA | Explain | Eff | Final |
|---|---:|---|---:|---:|---:|---:|---:|
| 2025-06-07 | 24.0 | base_safe | 20.83% | 50.00% | 15.22% | 81.87% | 38.04 |
| 2025-06-07 | 24.0 | node_strong_on | 12.50% | 45.83% | 8.70% | 81.87% | 32.39 |
| 2025-06-07 | 24.0 | node_strong_on_keep_replica | 16.67% | 45.83% | 8.70% | 81.87% | 34.06 |
| 2025-06-08 | 24.0 | base_safe | 8.33% | 54.17% | 7.41% | 81.87% | 33.93 |
| 2025-06-08 | 24.0 | node_strong_on | 8.33% | 54.17% | 3.70% | 81.87% | 33.56 |
| 2025-06-08 | 24.0 | node_strong_on_keep_replica | 4.17% | 41.67% | 0.00% | 81.87% | 26.52 |

## 预测 component 分布（Top-5）

说明：该表用于快速观察是否出现 ‘adservice 坍缩’（例如 Top-1 占比异常高）。

| date | 方案key | Top-5 components（component:count） |
|---|---|---|
| 2025-06-07 | base_safe | checkoutservice:10; adservice:8; aiops-k8s-07:3; aiops-k8s-04:1; emailservice:1 |
| 2025-06-07 | node_strong_on | checkoutservice:9; adservice:7; aiops-k8s-07:5; aiops-k8s-03:1; aiops-k8s-04:1 |
| 2025-06-07 | node_strong_on_keep_replica | adservice:7; checkoutservice:6; aiops-k8s-07:5; cartservice:3; aiops-k8s-03:1 |
| 2025-06-08 | base_safe | checkoutservice:12; adservice:8; aiops-k8s-07:2; aiops-k8s-08:1; hipstershop:1 |
| 2025-06-08 | node_strong_on | adservice:8; checkoutservice:7; aiops-k8s-07:5; aiops-k8s-08:2; aiops-k8s-04:1 |
| 2025-06-08 | node_strong_on_keep_replica | adservice:10; aiops-k8s-07:5; checkoutservice:4; cartservice:2; aiops-k8s-04:1 |

## 产物路径
- submissions: `outputs/experiments/la_boost_v5_node_strong_override/`
- filtered gt: `tmp/filtered/` (gt_YYYY-MM-DD_*.jsonl)
