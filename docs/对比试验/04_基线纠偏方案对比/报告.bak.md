# 基线纠偏方案对比

目标：在固定数据口径下，比较多种方案对 Final（以及 LA/TA/Explainability/Efficiency）的影响。

## 试验设置
- metadata: `../metadata_phase1.csv`
- ground truth: `../AIOpsChallengeJudge/ground_truth_phase1.jsonl`
- telemetry root: `../data`
- dates（按天全量）: 2025-06-07, 2025-06-08
- suite slug: `bias_fix_v1`（对应 outputs/experiments/bias_fix_v1/）

## 候选方案
- 方案A：基线（padding=20）（key=base_p20）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_STRIP_REPLICA_SUFFIX": "1"}`
- 方案B：开启 hints 温和加成（bonus=0.15）（key=hint_015）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "1", "RCA_HINT_BONUS": "0.15", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_STRIP_REPLICA_SUFFIX": "1"}`
- 方案C：关闭 component 先验（scale=0）（key=no_prior）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "0.0", "RCA_STRIP_REPLICA_SUFFIX": "1"}`
- 方案D：保留副本后缀（不剥离 -0/-1）（key=keep_replica）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_STRIP_REPLICA_SUFFIX": "0"}`
- 方案E：保留副本 + hints 加成（key=keep_replica_hint）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "1", "RCA_HINT_BONUS": "0.15", "RCA_COMPONENT_PRIOR_SCALE": "1.0", "RCA_STRIP_REPLICA_SUFFIX": "0"}`
- 方案F：保留副本 + 关闭先验（key=keep_replica_no_prior）
  - env: `{"RCA_COMPONENT_SOURCE": "consensus", "RCA_WINDOW_PADDING_MIN": "20", "RCA_ENABLE_MODALITY_BONUS": "0", "RCA_ENABLE_HINT_BONUS": "0", "RCA_COMPONENT_PRIOR_SCALE": "0.0", "RCA_STRIP_REPLICA_SUFFIX": "0"}`

## 结果汇总（按日期评测；并给出跨日期平均）

| 方案 | 平均LA | 平均TA | 平均Explain | 平均Eff | 平均Final |
|---|---:|---:|---:|---:|---:|
| 方案A：基线（padding=20） | 16.67% | 93.75% | 30.80% | 81.87% | 55.43 |
| 方案B：开启 hints 温和加成（bonus=0.15） | 16.67% | 95.83% | 30.03% | 81.87% | 56.19 |
| 方案C：关闭 component 先验（scale=0） | 16.67% | 95.83% | 26.77% | 81.87% | 55.86 |
| 方案D：保留副本后缀（不剥离 -0/-1） | 14.58% | 89.58% | 33.41% | 81.87% | 53.20 |
| 方案E：保留副本 + hints 加成 | 14.58% | 83.33% | 33.41% | 81.87% | 50.70 |
| 方案F：保留副本 + 关闭先验 | 14.58% | 77.08% | 29.39% | 81.87% | 47.79 |

## 分日期明细

| date | N | 方案key | LA | TA | Explain | Eff | Final |
|---|---:|---|---:|---:|---:|---:|---:|
| 2025-06-07 | 24.0 | base_p20 | 16.67% | 100.00% | 28.26% | 81.87% | 57.68 |
| 2025-06-07 | 24.0 | hint_015 | 16.67% | 100.00% | 30.43% | 81.87% | 57.90 |
| 2025-06-07 | 24.0 | no_prior | 16.67% | 95.83% | 23.91% | 81.87% | 55.58 |
| 2025-06-07 | 24.0 | keep_replica | 12.50% | 95.83% | 26.09% | 81.87% | 54.13 |
| 2025-06-07 | 24.0 | keep_replica_hint | 12.50% | 95.83% | 26.09% | 81.87% | 54.13 |
| 2025-06-07 | 24.0 | keep_replica_no_prior | 12.50% | 75.00% | 21.74% | 81.87% | 45.36 |
| 2025-06-08 | 24.0 | base_p20 | 16.67% | 87.50% | 33.33% | 81.87% | 53.19 |
| 2025-06-08 | 24.0 | hint_015 | 16.67% | 91.67% | 29.63% | 81.87% | 54.48 |
| 2025-06-08 | 24.0 | no_prior | 16.67% | 95.83% | 29.63% | 81.87% | 56.15 |
| 2025-06-08 | 24.0 | keep_replica | 16.67% | 83.33% | 40.74% | 81.87% | 52.26 |
| 2025-06-08 | 24.0 | keep_replica_hint | 16.67% | 70.83% | 40.74% | 81.87% | 47.26 |
| 2025-06-08 | 24.0 | keep_replica_no_prior | 16.67% | 79.17% | 37.04% | 81.87% | 50.22 |

## 产物路径
- submissions: `outputs/experiments/bias_fix_v1/`
- filtered gt: `tmp/filtered/` (gt_YYYY-MM-DD_*.jsonl)
